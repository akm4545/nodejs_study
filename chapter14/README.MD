# **웹소켓을 사용한 실시간 채팅 구현하기**  
# **웹소켓 소개**  
지금까지는 서버에 요청을 보내서 응답을 받는 애플리케이션을 만들었다. 사용자가 직접 화면을 갱신하지 않아도 자동으로 화면을 갱신하는 애플리케이션도 있다. 
주식이나 채팅 애플리케이션이 그 예이다. 이러한 일을 하려면 서버에 주기적으로 요청을 보내서 받아오거나 서버에서 데이터를 보내주어야 한다.  
  
![img.png](image/img.png)  
  
웹은 HTTP 프로토콜 위에서 동작하고 있기 때문에 요청을 보내야지만 서버가 응답을 주게 된다. 즉 양방향 통신을 지원하지 않는다. 그렇다고 주기적으로 
받아오는 것은 매우 비효율적이다. 몇 초에 한 번씩 서버가 알아서 응답을 주면 좋은데 단방향 통신이므로 클라이언트에서 주기적으로 의미없는 요청을 
보내야 하기 때문이다.  
  
![img.png](image/img2.png)  
  
이럴 때 웹소켓(WebSocket)을 사용한다. 웹소켓 이전에는 폴링 또는 롱폴링이라는 방법을 사용했다. 폴링은 주기적으로 요청을 보내는 방식이고 롱폴링은 
클라이언트와 서버 간의 커넥션을 유지한 상태로 응답을 주고받는 방식이다. 클라이언트가 서버로 요청을 보내면 서버는 클라이언트의 요청을 기다린다. 
그리고 요청한 데이터에 변화가 있을 때 응답을 보낸다. 폴링이나 롱폴링은 둘 다 클라이언트가 서버에 요청을 보내야 한다.  
  
![img.png](image/img3.png)  
  
웹소켓은 하나의 TCP 커넥션으로 서버와 클라이언트 간에 양방향 통신을 할 수 있게 만든 프로토콜이다. 2023년 기준 거의 대부분의 웹브라우저에서 안정적으로 
사용할 수 있다. 오래된 브라우저를 지원하려면 socket.io 같은 라이브러리를 사용해 폴링이나 롱폴링을 사용해 기능을 구현해야 한다. 웹소켓은 양방향 
통신을 지원하므로 브라우저 상에서 리프레시 없이 실시간성을 요구하는 애플리케이션을 구현할 수 있다.  
  
![img.png](image/img4.png)  
  
웹소켓의 특징은 크게 두 가지다. 첫 번째 특징은 양방향 통신이다. 이는 데이터의 송수신을 동시에 처리한다는 뜻이며 클라이언트와 서버가 원하는 때 
데이터를 주고받을 수 있다는 의미다. 통상적인 HTTP 통신은 클라이언트가 요청하는 때만 서버가 응답하는 단방향 통신이었다. 두 번째 특징으로는 실시간 
네트워킹을 구현하는 것이 용이하다는 것이다. 웹 환경에서 연속된 데이터를 빠르게 노출하고 싶은 때 (채팅, 주식) 적합하다. 또한 브로드캐스팅을 지원하므로 
여러 클라이언트와 빠르게 데이터를 교환할 수 있어 편리하다.  
  
